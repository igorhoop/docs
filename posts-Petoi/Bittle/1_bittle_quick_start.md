# Инструменты и подготовка
## Подготовка
Приготовьте чистый стол и несколько небольших коробок, чтобы распаковать упаковку. Сфотографируйте содержимое набора на случай, если впоследствии вы что-то потеряете.  
>Лучше работать в помещении без ковра или фактурной мозаики. Маленькие винтики и пружинки могут волшебным образом исчезнуть, если их уронить на пол.  
## Инструменты
- Шлицевая и крестовая отвертки (диаметр винтов 2мм)
- Компьютер с Windows/Mac/Linux (скачайте [Petoi Descktop APP](https://github.com/PetoiCamp/OpenCat/releases) и установите последнюю версию [Arduino IDE](https://www.arduino.cc/en/software))  
- Сетевое зарядное устройство USB 5V 1A 

# Распаковка
> Собака поставляется в двух вариантах: собранном и разобранном  
![комплектация](/assets/images/equipment.jpeg){: width="400px"}  
## Собранный вариант
Если вы выбрали собранный вариант, вам нужно вставить голову в разъем на теле и выставить ноги в нормальное положение  
Перетяните провода со стороны коленей на сторону плеч, чтобы избежать пережимания при вращении коленных суставов  
![поза для вставания](/assets/images/gettingup.webp){: width="400px"}  
# Включение
Длительное нажатие на кнопку на батарее в течение 2~3 секунд включает/выключает питание.  
Вытащите изоляционную пленку из батареи инфракрасного пульта дистанционного управления, после чего вы сможете управлять собакой с его помощью.  
При разрядке аккумулятора робот будет приостанавливать свои движения, издавая звуковые сигналы. Тогда необходимо зарядить аккумулятор с помощью кабеля micro-USB 5 В. В целях безопасности во время зарядки аккумулятор не будет подавать питание.



>Если при калибровке голень вашего Биттла находится в правильном направлении, но не двигается, вы можете повернуть ее в нужном направлении. Вы должны почувствовать умеренное сопротивление, пока шарнир не зафиксируется в нужном положении. Причина в том, что новые шестерни немного слишком тугие, и большое сопротивление при загрузке приведет к срабатыванию алгоритма защиты. Сервопривод уменьшит усилие на шарнире, чтобы избежать перегрузки по току, что остановит движение шарнира.  

Значение звуковых сигналов:


| Звук                  | Событие                          |Объяснение |
| --------              | -------                          | --------- |
| Короткая мелодия      | Включение или перезагрузка       |Успешный  запуск |
| Короткий бип          | Во время использования           |Получена команда| 
| Повторяющаяся мелодия | Во время использования и приостановки движений |атарея разряжена или не подключена|


> Заранее собранная собака имеет предварительную настройку, для лучшего опыта необходимо ее откалибровать.  




# Калибровка
>Калибровка крайне важна для правильной работы робота.  
>Перед калибровкой убедитесь в том, что вы загрузили прошивку OpenCat Main function. Калибровка через данное приложение возможна только в версии программного обеспечения 2.0.  



## Вход в состояние калибровки
 
Если у вас заранее собранная модель, то нужно раскрутить винты в ногах и головеё.

![калибровка](/assets/images/calibration3.webp){: width="400px"}  


Необходимо подключить USB-адаптер или Bluetooth-модуль (только для NyBoard) к компьютеру, установить аккумулятор и длительным нажатием кнопки на аккумуляторе включить  робота.  

Откройте приложение Petoi Desctop APP и нажмите joint calibration.   


![калибровка](/assets/images/calibration1.png){: width="400px"}  
Теперь робот находится в состоянии калибровки, устанновите голову в пазы так, чтобы она смотрела вперед.  



![калибровка](/assets/images/calibration5.png){: width="400px"}  
Установите ноги максимально близко к варианту на фото используя инструмент для калибровки  


![калибровка](/assets/images/calibration6.png){: width="400px"}
Если ноги стоят не точно под прямым углом, то сдвигайте ползунки соответствующих суставов пок не добьетесь результата.  



![калибровка](/assets/images/calibration2.png){: width="400px"}  

>Если смещение составляет более +/- 9 градусов, необходимо снять соответствующую ножку и установить ее заново, повернув на один зуб, а затем перетащить соответствующий ползунок. Например, если он отрегулирован на +9 и все равно не подходит, снимите соответствующую ножку и при установке сдвиньте ее на один зуб. Тогда вы должны получить меньшее смещение в противоположном направлении.  

>Для проверки эффекта калибровки можно переключаться между режимами "Отдых", "Встать" и "Ходьба".  

После калибровки не забудьте нажать кнопку "Save", чтобы сохранить калибровочное смещение. В противном случае нажмите кнопку "Abort" для отказа от калибровочных данных. В случае обрыва связи можно сохранить калибровку в середине.  

После завершения калибровки  установите винты для фиксации деталей ног и сервоприводов.  

# Пульт управления

## Подготовка

![пульт](/assets/images/rc1.png){: width="400px"}  




Пульт не требует сопряжения. Убедитесь, что с него снята пластиковая изоляция, и при работе направьте передатчик пульта на приемник на спине робота. Если робот не реагирует, можно проверить передатчик с помощью камеры телефона. Если он не мигает при нажатии на кнопку, необходимо заменить батарейку.  

## Управление

![пульт](/assets/images/rc2.png){: width="400px"}  

- **Rest** опускает робота вниз и отключает сервоприводы. Его всегда можно нажать, если робот делает что-то странное.

- **Balance** - это нейтральное положение стоя. Робота можно толкнуть и он попытается восстановиться. Можно проверить способность робота балансировать на колеблющейся доске. Балансирование активируется в большинстве поз и походок.

- Нажатие **F/L/R** приводит к движению робота вперед/влево/вправо.

- **B** приведет к движению робота назад.

- **Calibrate** переводит робота в калибровочную позу и отключает гироскоп.

- **Stepping**  робот шагает на месте.

- **Crawl/walk/trot** - это походки, которые можно переключать и комбинировать их с кнопками направления.

- Кнопки после **trot** - это запрограмированные позы или другие навыки.

- **Gyro** (Гироскоп) включает/выключает гироскоп для самобалансировки. Выключение гироскопа может ускорить и стабилизировать медленные походки. Но это **НЕ рекомендуется** для более быстрых шагов, таких как **trot**. Автоматический подъем после переворота будет отключен, поскольку робот больше не будет знать, что он перевернулся.

- Различные поверхности имеют разное трение и влияют на эффективность ходьбы. Ковер будет слишком плотным для коротких ног робота. Он может только ползти **Crawl** по такой поверхности.

- Батарею можно двигать ближе к голове или к хвосту. Это позволит настроить центр масс, что очень важно для ходовых качеств.

- Во время ходьбы робот может подниматься/спускаться по небольшому уклону (<10 градусов).

> - Если после подключения USB-загрузчика робот продолжает издавать звуковые  
> сигналы это означает, что сработала сигнализация низкого напряжения. 
> Необходимо запитать плату от аккумулятора.  

> - Сервоприводы сконструированы таким образом, что они должны приводятся в 
> движение внутренними шестернями. Избегайте слишком быстрого вращения 
>  сервоприводов снаружи.  

> - Не держите робот включенным слишком долго. Это приведет к перегреву
> электроники и сокращению срока службы сервоприводов.  

> - Если вы чувствуете, что с роботом что-то не так, нажмите кнопку 
> сброса(reset) на главной плате, чтобы перезапустить программу.  

> - Будьте добры, как будто вы играете с настоящим щенком (^=◕ᴥ◕=^).  


## Обновление прошивки


При использовании USB-загрузчика для обновления прошивки NyBoard, пожалуйста, сначала загрузите и установите драйвер:  

- [Mac](http://www.wch-ic.com/download/CH341SER_MAC_ZIP.html)
- [Windows](http://www.wch-ic.com/downloads/CH341SER_EXE.html)
- [Linux](http://www.wch-ic.com/downloads/CH341SER_LINUX_ZIP.html)

Загрузите последнюю версию программы [Petoi Descktop APP](https://github.com/PetoiCamp/OpenCat/releases)  

> Возможны некоторые проблемы совместимости на разных компьютерах.
> Вы по-прежнему можете запускать приложение непосредственно из терминала:
> 1. Откройте OpenCat/pyUI/ в терминале.
> 2. Установите pyserial, pillow для Python. pip3 install pyserial pillow
> 3. Запустите python3 UI.py


Для NyBoard загрузчик прошивок вызывает приложение avrdude для загрузки файлов прошивок на основную плату. Для BiBoard загрузчик прошивки вызывает приложение esptool для загрузки файлов прошивки на основную плату.  

> Установите avrdude в ОС Linux
> Для пользователей Linux, помимо описанных выше действий, необходимо выполнить следующие шаги:
> 1. Установите avrdude
>    - Fedora : dnf install avrdude
>    - CentOS : yum install avrdude
>    - Debian / Ubuntu : apt install avrdude
> 2. Изменените переменную avrdudeconfPath в файле FirmwareUploader.py
>    - Fedora / CentOS : avrdudeconfPath = '/etc/avrdude/'
>    - Debian / Ubuntu : avrdudeconfPath = '/etc/'

### Подключение платы к компьютеру


Вставьте 6-контактный разъем (H1) USB-загрузчика в гнездо загрузчика платы NyBoard, а затем с помощью входящего в комплект USB-кабеля для передачи данных подключите один его конец к интерфейсу MicroUSB модуля USB-загрузчика, а другой - к интерфейсу USB компьютера.  


![прошивка](/assets/images/update2.png){: width="400px"}
 Проверьте подключенние :


![прошивка](/assets/images/update1.png){: width="400px"}
Откройте PetoiDesktopApp и выберите модель и язык.



![прошивка](/assets/images/update3.png){: width="400px"}

Нажмите кнопку Firmware Uploader и выберите нужные значения


![прошивка](/assets/images/update4.png){: width="400px"}
>Программа версии 1.0 не будет корректно работать с Joint Calibrator, Skill >Composer и другими API. Используйте его только в том случае, если вы хотите >использовать CodeCraft (графический интерфейс кодирования от нашего партнера, >компании TinkerGen)
### Опции обновления

- Сброс к заводским настройкам
  Автоматически сбрасывает все параметры, включая все калибровочные параметры сервоприводов и IMU. Поэтому она не рекомендуется обычным пользователям.

- Обновление прошивики
  Обновляет не только саму прошивку, но и все параметры
  Это обязательно, если вы только что скачали десктопное приложение
  Для того чтобы сохранить калибровочные значения выберите 'N' во всплывающих окнах

- Изменение режима
  Если после загрузки новой версии этого приложения вы хотя бы раз обновили прошивку, то переключение между режимами можно осуществлять без обновления параметров. Это происходит быстрее за счет пропуска этапа перебора параметров.


### Процесс обновления прощивик для NyBoard

После нажатия кнопки Upgrade the Firmware сразу же начинается процесс загрузки. В строке состояния внизу в режиме реального времени будет отображаться текущий прогресс, а также результаты ключевых процессов.  

После успешной загрузки параметров прошивки плата начинает самостоятельно запускать программу конфигурирования. При этом будут последовательно появляться окна с сообщениями для подтверждения или отмены:  

- Reset joint offsets? (Y/N)\
Выберите "Да", и программа обнулит все параметры калибровки сервопривода, а в строке состояния в режиме реального времени будут обновляться данные о соответствующем процессе и результате..

Выберите "Нет", и программа пропустит этот шаг.


- Calibrate IMU? (Y/N)

Выберите "Да", и программа выполнит калибровку гироскопа (IMU), а в строке состояния в режиме реального времени будет отображаться информация о соответствующем процессе и результате.

Выберите "Нет", и программа пропустит этот шаг.

>Внимание
>Перед нажатием кнопки "Да" убедитесь, что материнская плата расположена >горизонтально.
>При первой загрузке этой версии прошивки обязательно нажмите кнопку "Да"!


После выполнения всех шагов появится окно с сообщением "Инициализация параметров завершена!". Для перехода ко второму этапу нажмите ok.


![прошивка](/assets/images/update5.png){: width="400px"}  

### Завершение процесса обновления


После завершения загрузки в строке состояния появится соответствующее сообщение об успешной или неуспешной загрузке микропрограммы. При успешной загрузке появляется окно сообщения "Firmware upload complete!".  

![прошивка](/assets/images/update6.png){: width="400px"}
>При первом открытии программы и загрузке прошивки сначала загружается микропрограмма "Параметры", а затем микропрограмма "Основная функция". При повторной загрузке после успешной выгрузки программа загрузит только прошивку "Main function", если вы изменили только параметр "Mode".\
>Если NyBoard не подключена к батарее и не включена, вы услышите повторяющиеся нисходящие мелодии, что свидетельствует о том, что батарея разряжена или не подключена. Необходимо подключить батарею и включить ее питание.

