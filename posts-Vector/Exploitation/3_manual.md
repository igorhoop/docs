# Приложение Вектор. Инструкция по эксплуатации.

Приложение для взаимодействия с ПО Вектор поддерживается на устройствах с ОС Android не ниже 9 версии и работает в следующих режимах: 
### 1. Построение карты;
### 2. Построение карты (PRO);
### 3. Формирование маршрута;
### 4. Следовать по маршруту;
### 5. Циклический маршрут.
Приложение рекомендуется использовать на планшетах, для наиболее оптимального управления.
   
## Подготовка к работе
Перезагрузите робота, если он включен, или ранее вы управляли им с пульта.  
    В начале работы на устройстве необходимо подключиться к Wi-Fi робота и запустить соответствующее приложение. Для стабильной работы рекомендуется включить опцию подключаться автоматически на Wi-Fi робота, и убрать эту опцию со всех остальных запомненных сетей. Выберите модель робота, к которому выполнено подключение. Для выбора робота следует действовать пошагово по изображениям, приведенным на рисунках с 1 по 3. На рисунке 1 необходимо нажать на экране кнопку «Выберите модель». Далее на рисунке 2 из выпадающего списка следует нажатием кнопки выбрать необходимую модель робота. На рисунке 3 следует нажать на экране кнопку «Начать».   
В случае, если подключиться к роботу не удалось, в приложении появится соответствующее сообщение. В таком случае, рекомендуется проверить, что вы подключены именно к WI-FI робота, и попробовать еще раз нажать на кнопку старт. В случае повторной ошибки, попробуйте перезагрузить робота.   
                  			
<center>
<img src="/assets/images/v1.jpg" width="500px"/>
</center>

<center>
Рисунок 1 – Начальный экран приложения при запуске
</center>

<center>
<img src="/assets/images/v2.jpg" width="500px"/>
</center>

<center>
Рисунок 2 – Выбор модели робота
</center>

<center>
<img src="/assets/images/v3.jpg" width="500px"/>
</center>

<center>
Рисунок 3 – Выбранная модель робота готова к настройке   
</center>
      
После подключения к роботу, необходимо выбрать режим работы, карту (доступно в режимах формирование маршрута, следование по маршруту и циклический маршрут), и маршрут (доступно в режимах следование по маршруту и циклический маршрут). Для выбора, нажмите на соответствующую кнопку, и выберите из списка.   

Предварительно можно скорректировать настройки на роботе. Нажмите кнопку "НАСТРОЙКИ" и задайте нужные вам параметры в соотвествии с особенностями поверхности вашей карты. (рисунок 4). После введения настроек, нажмите на кнопку отправить.   

<center>
<img src="/assets/images/v6.jpg" width="500px"/>
</center>

<center>
Рисунок 4 – Настройки скорости и высоты препятствий 
</center>

```note
Скорость макс - это максимальная скорость с которой робот будет двигаться вперед.    
Ускорение макс - это максимальное ускорение при разгоне робота вперед.    
Препятствие макс - это максимальное значение высоты препятствия, выше которого робот будет пытаться обойти препятствие, а если объект ниже, то робот будет пытаться его перешагнуть.     
Препятствие мин - это минимальная высота объектов, которые робот не считает преградой и будет перешагивать их автоматически при обнаружении.   
```
После построения карты, её можно отредактировать. Для этого можно нажать на кнопку сохранить/отправить. При первом нажатии, карта сохраняется на устройстве и ее можно отредактировать с помощью сторонних редакторов, поддерживающих работу с форматом .png (например Xgimp). Карта сохраняется в папке Camera. При повторном нажатии карта отправляется на робота. В случае, если вы не хотите редактировать карту, либо хотите отменить редактирование, просто удалите файл.

```note
Чтобы карта и фотографии сохранялись на андроид устройстве корректно, необходимо предоставить приложению права доступа на взаимодействия с файловой системой. Для этого зажмите пальцем на иконке приложения, перейдите в инфо, нажмите на разрешения и предоставьте приложению доступ к файловой системе.
```

Существует второй способ отредактировать карту прямо на самом роботе. Для этого вам потребуется ноутбук с установленным teamviewer версии не ниже 15.38.3.   
Подключитесь к Wi-Fi робота. Откройте teamviewer и в правом верхнем углу введите IP-адрес компьютера с ПО "Вектор", находящегося на вашем роботе (Рисунок 5).   
Нажмите Enter и введите пароль. У вас на экране откроется рабочий стол компьютера робота. 

<center>
<img src="/assets/images/teamv.png" width="700px"/>
</center>

<center>
Рисунок 5 – TeamViewer
</center>

   
Откройте проводник и перейдите в каталог release (рисунок 6), который находится по следующему адресу: /home/docker/vector/vector_packages/vector/vector_2dnav/maps/release

<center>
<img src="/assets/images/map_path.png" width="1000px"/>
</center>

<center>
Рисунок 6 – Путь к карте
</center>
   
Нажмите правой кнопкой мыши по нужной вам карте и выберите Open With Other Application (Рисунок 7). Выберите графический редактор GIMP (Рисунок 8).

<center>
<img src="/assets/images/open_map.png" width="1000px"/>
</center>

<center>
Рисунок 7 
</center>

<center>
<img src="/assets/images/gimp.png" width="500px"/>
</center>

<center>
Рисунок 8 
</center>
   
У вас на экране откроется построенная вами карта (Рисунок 9). В данном редакторе вы можете изменить вашу карту, путем нанесения серого, черного или белого цвета на карту.

```note
Серый цвет - это неизвестная для робота зона.   
Белый цвет - это зона, где робот может свободно перемещаться.     
Черный цвет - это преграды.  
```

<center>
<img src="/assets/images/map_view.png" width="1000px"/>
</center>

<center>
Рисунок 9 
</center>
   
После внесения изменений вам нужно сохранить карту на роботе. Нажмите File, а потом Export As, как на рисунке ниже.
<center>
<img src="/assets/images/export.png" width="300px"/>
</center>

<center>
Рисунок 10 
</center>
   
Нажмите на название вашей карты .png и не изменяя его нажмите Export. В новом окне ещё раз нажмите Export, как на рисунках ниже. 

<center>
<img src="/assets/images/pngSave.png" width="1000px"/>
</center>

<center>
Рисунок 11
</center>

<center>
<img src="/assets/images/confirmExport.png" width="300px"/>
</center>

<center>
Рисунок 12 
</center>
   
Теперь у вас на роботе новая карта с вашими изменениями. Закройте редактор gimp (карту в нем можно не сохранять) и закройте teamviewer.   
   
  
## 1) Построение карты 
```note
Внимание!! Перезагрузите робота перед построением новой карты.
```
 1.1. Выберите сюжет «Построение карты». Для выбора сюжета следует действовать пошагово по изображениям, приведенным на рисунках с 13 по 14. На рисунке 13 необходимо нажать на экране кнопку выпадающего меню «Сюжет»;   
 1.2. На рис. 14 из выпадающего списка следует нажать «Построение карты»;    
 1.3  Нажмите кнопку СТАРТ. В главном окне программы будет выведено изображение с камеры робота.   
 
<center>
<img src="/assets/images/v20.jpg" width="700px"/>
</center>

```note
Сюжет "Построение карты" отличается от "Построение карты (PRO)" тем, что в PRO сюжете отображается локальная карта препятствий, а в обычном построении нет. В обычном построении карты отключена функция автоматического следования к выделенной точке.
```
Вся последовательность действий в данном сюжете совпадает с сюжетом "Построение карты (PRO)", который описан ниже, начиная с пункта 2.3.

## 2) Построение карты (PRO)
   2.1. Выберите сюжет «Построение карты (PRO)». Для выбора сюжета следует действовать пошагово по изображениям, приведенным на рисунках с 13 по 14 (на рис. 13 необходимо нажать на экране кнопку выпадающего меню «Сюжет»;   
   2.2. На рис. 14 из выпадающего списка следует нажать «Построение карты (PRO)»;   

<center>
<img src="/assets/images/v4.jpg" width="500px"/>
</center>

<center>
Рисунок 13 – Основное меню управления
</center>

<center>
<img src="/assets/images/v5.jpg" width="500px"/>
</center>

<center>
Рисунок 14 – Выбор сюжета
</center>

  2.3 Нажмите кнопку СТАРТ. У вас на экране должна прогрузиться локальная карта препятствий. При работе с роботом Deep Robotics, нажмите кнопку ХОДЬБА. Робот должен начать топать. В ручном режиме управляйте джойстиками, чтобы провести робота по помещениям/местности, которые необходимо отсканировать. Вести робота необходимо с промежуточными остановками не менее 5 секунд на углах и поворотах. Максимальная площадь для построения карты составляет 15000 м2.
  
```note   
Переключение между камерой и локальной картой:    
Для переключения между отображением видео с камеры робота и локальной картой, необходимо нажать на изображение в левом верхнем углу.  
  
Проверка уровня заряда батареи робота:    
Уровень заряда аккумулятора робота отображается в правом верхнем углу экрана локальной карты препятствий (см рисунок 15.1). Отображается для моделей от DeepRobotics и Unitree. 
```

<center>
<img src="/assets/images/v7.jpg" width="700px"/>
</center>

<center>
Рисунок 15.1 Основное меню управления роботом с примером карты    
</center>

<center>
<img src="/assets/images/v8.jpg" width="700px"/>
</center>	

<center>
Рисунок 15.2 — Основное меню управления роботом с примером карты    
</center>
  
  2.4 По окончании сканирования нажмите ГЛОБАЛЬНАЯ, чтобы оценить текущий результат построения глобальной карты (для помещений, например, см.
рис. 16).

<center>
<img src="/assets/images/v9.jpg" width="700px"/>
</center>	

<center>
Рисунок 16 — Пример отображения глобальной карты    
</center>

2.5 Нажмите СОХРАНИТЬ КАРТУ. Введите название карты и название папки на роботе, в которую будет сохранена карта. Нажмите СОХРАНИТЬ. После закрытия окна карта будет сохранена на роботе.

<center>
<img src="/assets/images/v10.jpg" width="700px"/>
</center>	

<center>
Рисунок 17 — Сохранение карты    
</center>

2.6 Вернитесь назад в главное меню и нажмите "ЗАВЕРШИТЬ". Согласитесь на завершение и дождитесь закрытия всплывающего окна.

## 3) Формирование маршрута
3.1. Перед началом работы убедитесь, что робот находится в своей стартовой точке.    
3.2. В главном меню перейдите в СЮЖЕТ.    
3.3. Выберите сюжет «Формирование маршрута» (см. рисунок 13).    
3.4. Перейдите в КАРТЫ. Выберите название построенной карты.    
3.5. Нажмите кнопку СТАРТ.    
3.6. Если робот неправильно локализовался и неверно отображается на глобальной карте (ГЛОБАЛЬНАЯ), можно вручную указать положение робота на карте и его направление. Для этого нажмите на кнопку "Задать позицию", после чего нажмите на карту, и, не отпуская пальца, проведите пальцем по карте в направлении, куда смотрит робот.     
3.7. Робота можно перемещать в нужную точку. Для этого кликните на значок, представленный на рисунке 18. Нажмите и проведите пальцем на экране, не отпуская пальца, в той точке на карте, в которую нужно переместиться роботу. После отображения точки на карте ещё раз нажмите на экран для подтверждения. Робот должен отправиться к поставленной точке.    

<center>
<img src="/assets/images/v11.png" width="300px"/>
</center>	

<center>
Рисунок 18. 
</center>

 3.8. Нажмите ДОБАВИТЬ ТОЧКУ +. Введите название точки и время ожидания в точке в секундах.     
 3.9. Две точки, это минимальное количество точек для создания маршрута. Переместите робота в ручном режиме до следующей точки маршрута. Сохраните точку, и так далее необходимо сделать со всеми точками маршрута.     
 3.10. В меню формирования маршрута, вы можете удалить ненужные точки. Для  этого нажмите на название точки (либо одной, либо нескольких последовательно), и нажмите кнопку удалить. После того, как все ненужные точки будут удалены, нажмите ОТПРАВИТЬ.    

<center>
<img src="/assets/images/v12.jpg" width="700px"/>
</center>	

<center>
Рисунок 19 — Сохранение маршрута
</center>

ПО "Вектор" поддерживает переключение между несколькими картами. Установка точек перехода между картами доступна в режиме формирование маршрута. Для сохранения точек, в которых робот будет автоматически переключать карту на другую, нужно подвести робота к нужной точке, перейти на глобальную карту, нажать на кнопку "Точка перехода", затем переключить карту. Не завершая сессию, нажмите на кнопку "СМЕНИТЬ КАРТУ", расположенную на экране с глобальной картой (ГЛОБАЛЬНАЯ). Далее, просто нажмите на название нужной вам карты. Карта измениться автоматически (функция недоступна при выборе режимов построения карты). Установите правильное положение робота. Для этого нажмите на кнопку "Задать позицию", после чего нажмите на карту, и, не отпуская пальца, проведите пальцем по карте в направлении, куда смотрит робот. Затем нажмите на кнопку "Новая позиция" и после этого нажмите на "Сохранить переход".  

<center>
<img src="/assets/images/v13.jpg" width="700px"/>
</center>	

<center>
Рисунок 20
</center>

<center>
<img src="/assets/images/v14.jpg" width="700px"/>
</center>	

<center>
Рисунок 21 - Формирование окончательного маршрута
</center>

3.11. Для окончательной отправки маршрута на робота, перейдите на глобальную карту, и нажмите на сохранить маршрут. Появится новое всплывающее окно (рисунок 21). В нем необходимо сначала нажать на выберите карту, после чего в списке, появляющемся в левой части необходимо нажать на название нужной карты. После этого, в левой части окна будет выведен список доступных точек на выбранной карте. Для добавления точки в маршрут, нажмите на ее название. После того как точек будет больше двух, появиться поле, в которое нужно ввести название карты и кнопка отправить. Для удаления точки из списка, нажмите на ее название в правой части.    
3.12. Вернитесь обратно в главное меню и нажмите ЗАВЕРШИТЬ. После нажатия на эту кнопку, у вас попросят согласия на завершение работы. Нажмите на "ДА" и дождитесь закрытия окна с сообщением.    

## 4) Следование по маршруту
4.1. Перед началом работы убедитесь, что робот находится в своей стартовой точке.    
4.2. В главном меню перейдите в СЮЖЕТ.    
4.3. Выберите сюжет «Следование по маршруту» (см. рисунок 13)    
4.4. Перейдите в КАРТЫ. Выберите название построенной карты.    
4.5. Перейдите в МАРШРУТЫ. Выберите название сформированного маршрута.    
4.6. Нажмите кнопку СТАРТ.    

<center>
<img src="/assets/images/v19.jpg" width="700px"/>
</center>

4.7. Предварительно рекомендуется перейти на глобальную карту и проверить, что робот находиться в нужной позиции, при необходимости можно скорректировать позицию робота. Для этого перейдите на глобальную карту, нажмите на кнопку "Задать позицию+" и установите правильную позицию пальцем.     
4.8. Для начала следования по маршруту нажмите на кнопку "НАЧАТЬ МАРШРУТ".     
4.9. Чтобы вернуть робота к предыдущей точке можно нажать кнопку возврат во время выполнения маршрута.    
4.10. Чтобы отменить следование по маршруту, нажмите на кнопку отмена.    

```note
Внимание!! Вернутся к следованию по маршруту, без завершения работы робота не получиться!
```
4.11. Для завершения вернитесь назад в главное меню и нажмите ЗАВЕРШИТЬ. Согласитесь на завершение и дождитесь закрытия всплывающего окна.    

## 5) Цикличный маршрут
5.1. Перед началом работы убедитесь, что робот находится в своей стартовой точке.    
5.2. В главном меню перейдите в СЮЖЕТ.    
5.3. Выберите сюжет «Циклический маршрут» (см. рисунок 13)    
5.4. Перейдите в КАРТЫ. Выберите название построенной карты.    
5.5. Перейдите в МАРШРУТЫ. Выберите название сформированного маршрута.    
5.6. Нажмите кнопку СТАРТ.    

В данном сюжете последовательность действий ничем не отличается от сюжета "Следование по маршруту". Единственная разница в том, что робот в этом сюжете будет непрерывно курсировать по заданным точкам маршрута.

Запись фото и видео:  
<img src="/assets/images/v15.png" width="200px"/>   
Для записи видео, на экране локальной карты препятствий необходимо нажать на кнопку с изображением видеокамеры(слева на рисунке выше). Видео будет записано на роботе. Для завершения записи, необходимо будет нажать на эту кнопку повторно. Чтобы сделать фото, на экране локальной карты препятствий необходимо нажать на кнопку с изображением видеокамеры(справа на рисунке выше). Фото будет сохранено в память устройства, в папку Camera.


## Карта мира
<center>
<img src="/assets/images/v16.jpg" width="800px"/>
</center>
В случае, если на роботе установлен GPS- модуль, у вас будет возможность увидеть его местоположение на карте мира. Местоположение робота отмечено логотипом 3Logic. Также на карте мира зелеными прямоугольниками отмечены области, для которых вы ранее составляли карты. Для того, чтобы их убрать, нажмите на кнопку скрыть маски. Повторное нажатие заново нанесет их на карту.   
#### ВНИМАНИЕ для корректной работы, необходимо скачать карту вашего региона. Карта должна быть в формате .map и называться map. Также, в случае, если вы хотите воспользоваться данной опцией, вам нужно будет в настройках приложения выдать разрешение на доступ к памяти(все файлы).























